<!doctype html>
<html>
<head>
  <title>react calendar timeline Demo</title>
  <link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
</head>
<body style='font-family: "Lato";margin: 0;font-size: 13px;'>

    <div  id="myModal" class="modal fade" tabindex="-1" role="dialog" style="z-index: 100000;">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Modal title</h4>
          </div>
          <div class="modal-body">
            <p>One fine body&hellip;</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->


  <div id="main"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0/react.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.3/react-dom.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.2.6/interact.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/immutable/3.7.6/immutable.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Faker/3.0.1/faker.js"></script>
  <!-- <link href='build/dist/react-calendar-timeline.min.css' rel='stylesheet' type='text/css'>
  <script src="build/dist/react-calendar-timeline.min.js"></script> -->
  <link href='build/dist/react-calendar-timeline.css' rel='stylesheet' type='text/css'>
  <script src="build/dist/react-calendar-timeline.js"></script>
  <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <style>
    .react-calendar-timeline .rct-item.item-weekend {
      background: #21F32C;
      border-color: #29B31A;
    }
  </style>
  <script type="text/javascript">


    $(document).ready(function() {
      console.log('test')

     window.test = function ()
      {
        //$('#myModal').modal('toggle');

      }

    });


    GROUP_COUNT = 30
    ITEM_COUNT = 1000
    DAYS_IN_PAST = 30

    var groups = []

    for (var i = 0; i < GROUP_COUNT; i++) {
      groups.push({
        id: (i+1)+'',
        title: faker.name.firstName()
      })
    };

    var items = []

    for (var i = 0; i < ITEM_COUNT; i++) {
      var startDate = faker.date.recent(DAYS_IN_PAST).valueOf() + (DAYS_IN_PAST * 0.3) * 86400 * 1000;
      var startValue = moment(startDate).valueOf();
      var endValue = moment(startDate + faker.random.number({min: 2, max: 20})*15*60*1000).valueOf();
      items.push({
        id: i+'',
        group: faker.random.number({min: 1, max: groups.length})+'',
        title: faker.hacker.phrase(),
        start: startValue,
        end: endValue,
        phone:'000-000-000',
        fromDate:'10:20',
        toDate:'10:40',
        classView:'V/20',
        canMove: startValue > new Date().getTime(),
        canResize: endValue > new Date().getTime(),
        className: (moment(startDate).day() === 6 || moment(startDate).day() === 0) ? 'item-weekend' : ''
      })
    }

    items = items.sort(function(a, b) { return b - a; })

    //var minTime = moment().add(-6, 'months').valueOf()
    //var maxTime = moment().add(6, 'months').valueOf()
    var minTime = moment().startOf('day').add(-1, 'hour').toDate().valueOf()
    var maxTime = moment().startOf('day').add(1, 'day').add(1, 'hour').toDate().valueOf()

    var props = {
      groups: groups,
      items: items,
      fixedHeader: 'fixed',
      canMove: false, // defaults
      canResize: false,
      itemsSorted: true,
      itemTouchSendsClick: false,
      stackItems: true,
      itemHeightRatio: 0.75,

      defaultTimeStart: moment().startOf('day').hour(6).toDate(),
      defaultTimeEnd: moment().startOf('day').add(1, 'day').toDate(),

      minShowInHour: true,
      headerLabelGroupHeight:60,
      headerLabelHeight: 30,
      minLabelHeight: 20,

      keys: {
        groupIdKey: 'id',
        groupTitleKey: 'title',
        itemIdKey: 'id',
        itemTitleKey: 'title',
        itemGroupKey: 'group',
        itemTimeStartKey: 'start',
        itemTimeEndKey: 'end',
        itemFromDate: 'fromDate',
        itemUserName: 'username',
        itemFullName: 'fullname',
        itemPhone: 'phone',
        itemLevel: 'lv',
        itemTalkIdx: 'talkidx',
        itemTalkInterval: 'intervaldate',
        itemTalkStatus: 'talkstatus'
      },

      onItemClick: function(item) {
        console.log("Clicked: " + item);
      },

      onItemMove: function(item, dragTime, newGroupOrder)
      {
        var it = items[item];

        //items[item].start = dragTime

        console.log(dragTime)
        console.log(items[item].start);
      },

      moveResizeValidator: function(action, item, time) {
        if (time < new Date().getTime()) {
          var newTime = Math.ceil(new Date().getTime() / (15*60*1000)) * (15*60*1000);
          return newTime;
        }

        return time
      },

      // this limits the timeline to -6 months ... +6 months
      onTimeChange: function (visibleTimeStart, visibleTimeEnd) {
        if(!isNaN(visibleTimeStart) && !isNaN(visibleTimeEnd)) {
          if (visibleTimeStart < minTime && visibleTimeEnd > maxTime) {
            this.updateScrollCanvas(minTime, maxTime)
          } else if (visibleTimeStart < minTime) {
            this.updateScrollCanvas(minTime, minTime + (visibleTimeEnd - visibleTimeStart))
          } else if (visibleTimeEnd > maxTime) {
            this.updateScrollCanvas(maxTime - (visibleTimeEnd - visibleTimeStart), maxTime)
          } else {
            this.updateScrollCanvas(visibleTimeStart, visibleTimeEnd)
          }
        } else {
          visibleTimeStart = minTime
          visibleTimeEnd = maxTime
        }
      }
    }

    var filter = React.createElement("div", {}, "The filter");

    /* jshint undef:false */
    ReactDOM.render(React.createElement(ReactCalendarTimeline['default'], props, filter), document.getElementById('main'));




  </script>
</body>
</html>
